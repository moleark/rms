{"version":3,"sources":["../node_modules/tonva/dist/img/logo.svg","../../../src/entry/res/login.ts","../../../src/entry/res/register.ts","../../../src/entry/tools.tsx","../../../src/entry/register.tsx","../../../src/entry/login.tsx"],"names":["module","exports","this","openVPage"],"mappings":"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","file":"static/js/3.fc392e73.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.ee7cd8ed.svg\";","export const loginRes = {\r\n    _: {\r\n        a: 'd',\r\n    }\r\n};\r\n//# sourceMappingURL=login.js.map","export const registerRes = {\r\n    _: {\r\n        a: 'd',\r\n    }\r\n};\r\n//# sourceMappingURL=register.js.map","import * as React from 'react';\r\nimport { nav, mobileRegex, emailRegex } from '../components';\r\nconst logo = require('../img/logo.svg');\r\nexport function tonvaTop() {\r\n    return nav.loginTop(React.createElement(\"div\", { className: \"d-flex align-items-center\" },\r\n        React.createElement(\"img\", { className: \"App-logo h-3c position-absolute\", src: logo, alt: \"img\" }),\r\n        React.createElement(\"div\", { className: \"h3 flex-fill text-center\" },\r\n            React.createElement(\"span\", { className: \"text-primary mr-3\" }, \"\\u540C\"),\r\n            React.createElement(\"span\", { className: \"text-danger\" }, \"\\u82B1\"))));\r\n}\r\nconst senders = [\r\n    { type: 'mobile', caption: '手机号', regex: mobileRegex },\r\n    { type: 'email', caption: '邮箱', regex: emailRegex }\r\n];\r\nexport function getSender(un) {\r\n    let sender = senders.find(v => v.regex.test(un) === true);\r\n    return sender;\r\n}\r\n//# sourceMappingURL=tools.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as React from 'react';\r\nimport { nav, Page, Form, resLang, Controller, VPage } from '../components';\r\nimport { userApi } from '../net';\r\nimport '../css/va-form.css';\r\nimport { registerRes } from './res';\r\nimport { tonvaTop, getSender } from './tools';\r\n/*\r\nclass AccountInput extends TextWidget {\r\n    @observable private buttonDisabled: boolean = true;\r\n    private onClick = () => {\r\n        let {onButtonClick} = this.context.form.props;\r\n        if (onButtonClick === undefined) return;\r\n        onButtonClick(this.name, this.context);\r\n    }\r\n    protected onChange(evt: React.ChangeEvent<any>) {\r\n        this.buttonDisabled = (evt.target.value.trim().length === 0);\r\n    }\r\n    render() {\r\n        return <>\r\n            <div className=\"input-group\">\r\n                <input ref={input=>this.input = input}\r\n                            className=\"form-control\"\r\n                            type={this.inputType}\r\n                            defaultValue={this.value}\r\n                            onChange={(evt: React.ChangeEvent<any>) => this.onChange(evt)}\r\n                            placeholder='手机号/邮箱'\r\n                            readOnly={this.readOnly}\r\n                            disabled={this.disabled}\r\n                            onKeyDown = {this.onKeyDown}\r\n                            onFocus = {(evt: React.FocusEvent<any>) => this.onFocus(evt)}\r\n                            onBlur={(evt: React.FocusEvent<any>) => this.onBlur(evt)}\r\n                            maxLength={(this.itemSchema as StringSchema).maxLength} />\r\n                <div className=\"input-group-append\">\r\n                    <button className=\"btn btn-sm btn-outline-primary\"\r\n                        type=\"button\" disabled={this.buttonDisabled}\r\n                        onClick={this.onClick}>\r\n                        <small>发送验证码</small>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n            {this.renderErrors()}\r\n        </>;\r\n    }\r\n}\r\n*/\r\nexport class RegisterController extends Controller {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.accountPageCaption = '注册账号';\r\n        this.accountLabel = '注册账号';\r\n        this.accountSubmitCaption = '注册新账号';\r\n        this.passwordPageCaption = '账号密码';\r\n        this.passwordSubmitCaption = '注册新账号';\r\n        this.successText = '注册成功';\r\n        this.login = (account) => __awaiter(this, void 0, void 0, function* () {\r\n            let retUser = yield userApi.login({ user: account || this.account, pwd: this.password, guest: nav.guest });\r\n            if (retUser === undefined) {\r\n                alert('something wrong!');\r\n                return;\r\n            }\r\n            yield nav.logined(retUser);\r\n        });\r\n    }\r\n    internalStart() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.openVPage(AccountPage);\r\n        });\r\n    }\r\n    toVerify(account) {\r\n        this.account = account;\r\n        this.openVPage(VerifyPage);\r\n    }\r\n    toPassword() {\r\n        this.openVPage(PasswordPage);\r\n    }\r\n    toSuccess(accounts) {\r\n        this.openVPage(RegSuccess, accounts);\r\n    }\r\n    regReturn(registerReturn) {\r\n        let msg;\r\n        switch (registerReturn) {\r\n            default:\r\n                return '服务器发生错误';\r\n            case 4:\r\n                return '验证码错误';\r\n            case 0:\r\n                return;\r\n            case 1:\r\n                msg = '用户名 ' + this.account;\r\n                break;\r\n            case 2:\r\n                msg = '手机号 +' + this.account;\r\n                break;\r\n            case 3:\r\n                msg = '邮箱 ' + this.account;\r\n                break;\r\n        }\r\n        return msg + ' 已经被注册过了';\r\n    }\r\n    checkAccount() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let ret = yield userApi.isExists(this.account);\r\n            let error = this.accountError(ret);\r\n            if (error !== undefined)\r\n                return error;\r\n            ret = yield userApi.sendVerify(this.account, this.type, nav.oem);\r\n            this.toVerify(this.account);\r\n            return;\r\n        });\r\n    }\r\n    accountError(isExists) {\r\n        if (isExists > 0)\r\n            return '已经被注册使用了';\r\n    }\r\n    execute() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let params = {\r\n                nick: undefined,\r\n                user: this.account,\r\n                pwd: this.password,\r\n                country: undefined,\r\n                mobile: undefined,\r\n                mobileCountry: undefined,\r\n                email: undefined,\r\n                verify: this.verify\r\n            };\r\n            switch (this.type) {\r\n                case 'mobile':\r\n                    params.mobile = Number(this.account);\r\n                    params.mobileCountry = 86;\r\n                    break;\r\n                case 'email':\r\n                    params.email = this.account;\r\n                    break;\r\n            }\r\n            let ret = yield userApi.register(params);\r\n            if (ret === 0) {\r\n                nav.clear();\r\n                this.toSuccess();\r\n                return;\r\n            }\r\n            let error = this.regReturn(ret);\r\n            return error;\r\n        });\r\n    }\r\n}\r\nexport class ForgetController extends RegisterController {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.accountPageCaption = '密码找回';\r\n        this.accountLabel = '账号';\r\n        this.accountSubmitCaption = '注册新账号';\r\n        this.passwordPageCaption = '重置密码';\r\n        this.passwordSubmitCaption = '提交';\r\n        this.successText = '成功修改密码';\r\n    }\r\n    execute() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let ret = yield userApi.resetPassword(this.account, this.password, this.verify, this.type);\r\n            nav.clear();\r\n            this.toSuccess(ret);\r\n            return undefined;\r\n        });\r\n    }\r\n    accountError(isExists) {\r\n        if (isExists === 0)\r\n            return '请输入正确的账号';\r\n    }\r\n}\r\nclass AccountPage extends VPage {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.schema = [\r\n            { name: 'user', type: 'string', required: true, maxLength: 100 },\r\n            { name: 'verify', type: 'submit' },\r\n        ];\r\n        this.res = resLang(registerRes);\r\n        this.page = () => {\r\n            return React.createElement(Page, { header: this.controller.accountPageCaption },\r\n                React.createElement(\"div\", { className: \"w-max-20c my-5 py-5\", style: { marginLeft: 'auto', marginRight: 'auto' } },\r\n                    tonvaTop(),\r\n                    React.createElement(\"div\", { className: \"h-3c\" }),\r\n                    React.createElement(Form, { schema: this.schema, uiSchema: this.uiSchema, onButtonClick: this.onSubmit, onEnter: this.onEnter, requiredFlag: false }),\r\n                    nav.privacyEntry()));\r\n        };\r\n        this.onSubmit = (name, context) => __awaiter(this, void 0, void 0, function* () {\r\n            context.clearContextErrors();\r\n            let user = 'user';\r\n            let value = context.getValue(user);\r\n            let sender = getSender(value);\r\n            if (sender === undefined) {\r\n                context.setError(user, '必须是手机号或邮箱');\r\n                return;\r\n            }\r\n            let type = sender.type;\r\n            if (type === 'mobile') {\r\n                if (value.length !== 11 || value[0] !== '1') {\r\n                    context.setError(user, '请输入正确的手机号');\r\n                    return;\r\n                }\r\n            }\r\n            this.controller.account = value;\r\n            this.controller.type = type;\r\n            let ret = yield this.controller.checkAccount();\r\n            if (ret !== undefined)\r\n                context.setError(user, ret);\r\n        });\r\n        this.onEnter = (name, context) => __awaiter(this, void 0, void 0, function* () {\r\n            if (name === 'user') {\r\n                return yield this.onSubmit('verify', context);\r\n            }\r\n        });\r\n    }\r\n    open() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.uiSchema = {\r\n                items: {\r\n                    user: {\r\n                        widget: 'text',\r\n                        label: this.controller.accountLabel,\r\n                        placeholder: '手机号或邮箱',\r\n                    },\r\n                    verify: { widget: 'button', className: 'btn btn-primary btn-block mt-3', label: '发送验证码' },\r\n                }\r\n            };\r\n            this.openPage(this.page);\r\n        });\r\n    }\r\n}\r\nclass VerifyPage extends VPage {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.schema = [\r\n            { name: 'verify', type: 'number', required: true, maxLength: 6 },\r\n            { name: 'submit', type: 'submit' },\r\n        ];\r\n        this.onVerifyChanged = (context, value, prev) => {\r\n            context.setDisabled('submit', !value || (value.length !== 6));\r\n        };\r\n        this.uiSchema = {\r\n            items: {\r\n                verify: {\r\n                    widget: 'text',\r\n                    label: '验证码',\r\n                    placeholder: '请输入验证码',\r\n                    onChanged: this.onVerifyChanged,\r\n                },\r\n                submit: {\r\n                    widget: 'button',\r\n                    className: 'btn btn-primary btn-block mt-3',\r\n                    label: '下一步 >',\r\n                    disabled: true\r\n                },\r\n            }\r\n        };\r\n        this.onSubmit = (name, context) => __awaiter(this, void 0, void 0, function* () {\r\n            let verify = this.controller.verify = context.getValue('verify');\r\n            let ret = yield userApi.checkVerify(this.controller.account, verify);\r\n            if (ret === 0) {\r\n                context.setError('verify', '验证码错误');\r\n                return;\r\n            }\r\n            this.controller.toPassword();\r\n        });\r\n        this.onEnter = (name, context) => __awaiter(this, void 0, void 0, function* () {\r\n            if (name === 'verify') {\r\n                return yield this.onSubmit('submit', context);\r\n            }\r\n        });\r\n        this.page = () => {\r\n            let typeText, extra;\r\n            switch (this.controller.type) {\r\n                case 'mobile':\r\n                    typeText = '手机号';\r\n                    break;\r\n                case 'email':\r\n                    typeText = '邮箱';\r\n                    extra = React.createElement(React.Fragment, null,\r\n                        React.createElement(\"span\", { className: \"text-danger\" }, \"\\u6CE8\\u610F\"),\r\n                        \": \\u6709\\u53EF\\u80FD\\u8BEF\\u4E3A\\u5783\\u573E\\u90AE\\u4EF6\\uFF0C\\u8BF7\\u68C0\\u67E5\",\r\n                        React.createElement(\"br\", null));\r\n                    break;\r\n            }\r\n            return React.createElement(Page, { header: \"\\u9A8C\\u8BC1\\u7801\" },\r\n                React.createElement(\"div\", { className: \"w-max-20c my-5 py-5\", style: { marginLeft: 'auto', marginRight: 'auto' } },\r\n                    \"\\u9A8C\\u8BC1\\u7801\\u5DF2\\u7ECF\\u53D1\\u9001\\u5230\",\r\n                    typeText,\r\n                    React.createElement(\"br\", null),\r\n                    React.createElement(\"div\", { className: \"py-2 px-3 my-2 text-primary bg-light\" },\r\n                        React.createElement(\"b\", null, this.controller.account)),\r\n                    extra,\r\n                    React.createElement(\"div\", { className: \"h-1c\" }),\r\n                    React.createElement(Form, { schema: this.schema, uiSchema: this.uiSchema, onButtonClick: this.onSubmit, onEnter: this.onEnter, requiredFlag: false })));\r\n        };\r\n    }\r\n    open() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.openPage(this.page);\r\n        });\r\n    }\r\n}\r\nclass PasswordPage extends VPage {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.schema = [\r\n            { name: 'pwd', type: 'string', required: true, maxLength: 100 },\r\n            { name: 'rePwd', type: 'string', required: true, maxLength: 100 },\r\n            { name: 'submit', type: 'submit' },\r\n        ];\r\n        this.onSubmit = (name, context) => __awaiter(this, void 0, void 0, function* () {\r\n            let values = context.form.data;\r\n            let { pwd, rePwd } = values;\r\n            let error;\r\n            if (!pwd || pwd !== rePwd) {\r\n                context.setValue('pwd', '');\r\n                context.setValue('rePwd', '');\r\n                error = '密码错误，请重新输入密码！';\r\n                context.setError('pwd', error);\r\n            }\r\n            else {\r\n                this.controller.password = pwd;\r\n                error = yield this.controller.execute();\r\n                if (error !== undefined) {\r\n                    nav.push(React.createElement(Page, { header: \"\\u6CE8\\u518C\\u4E0D\\u6210\\u529F\" },\r\n                        React.createElement(\"div\", { className: \"p-5 text-danger\" }, error)));\r\n                }\r\n            }\r\n            return error;\r\n        });\r\n        this.onEnter = (name, context) => __awaiter(this, void 0, void 0, function* () {\r\n            if (name === 'rePwd') {\r\n                return yield this.onSubmit('submit', context);\r\n            }\r\n        });\r\n        this.page = () => {\r\n            return React.createElement(Page, { header: this.controller.passwordPageCaption },\r\n                React.createElement(\"div\", { className: \"w-max-20c my-5 py-5\", style: { marginLeft: 'auto', marginRight: 'auto' } },\r\n                    \"\\u6CE8\\u518C\\u8D26\\u53F7\",\r\n                    React.createElement(\"br\", null),\r\n                    React.createElement(\"div\", { className: \"py-2 px-3 my-2 text-primary bg-light\" },\r\n                        React.createElement(\"b\", null, this.controller.account)),\r\n                    React.createElement(\"div\", { className: \"h-1c\" }),\r\n                    React.createElement(Form, { schema: this.schema, uiSchema: this.uiSchema, onButtonClick: this.onSubmit, onEnter: this.onEnter, requiredFlag: false })));\r\n        };\r\n    }\r\n    open() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.uiSchema = {\r\n                items: {\r\n                    pwd: { widget: 'password', placeholder: '密码', label: '密码' },\r\n                    rePwd: { widget: 'password', placeholder: '重复密码', label: '重复密码' },\r\n                    submit: { widget: 'button', className: 'btn btn-primary btn-block mt-3', label: this.controller.passwordSubmitCaption },\r\n                }\r\n            };\r\n            this.openPage(this.page);\r\n        });\r\n    }\r\n}\r\nclass RegSuccess extends VPage {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.page = ({ users }) => {\r\n            const { account, successText, login } = this.controller;\r\n            if (users === undefined) {\r\n                return React.createElement(Page, { header: false },\r\n                    React.createElement(\"div\", { className: \"container w-max-30c\" },\r\n                        React.createElement(\"div\", { className: \"my-5\" },\r\n                            React.createElement(\"div\", { className: \"py-5\" },\r\n                                \"\\u8D26\\u53F7 \",\r\n                                React.createElement(\"strong\", { className: \"text-primary\" },\r\n                                    account,\r\n                                    \" \"),\r\n                                \" \",\r\n                                successText,\r\n                                \"\\uFF01\"),\r\n                            React.createElement(\"button\", { className: \"btn btn-success btn-block\", type: \"button\", onClick: () => login(undefined) }, \"\\u76F4\\u63A5\\u767B\\u5F55\"))));\r\n            }\r\n            else {\r\n                return React.createElement(Page, { header: false },\r\n                    React.createElement(\"div\", { className: \"container w-max-30c\" },\r\n                        React.createElement(\"div\", { className: \"my-5\" },\r\n                            React.createElement(\"div\", { className: \"py-5 text-success\" }, successText),\r\n                            users.map((v) => {\r\n                                let { name } = v;\r\n                                return React.createElement(\"div\", { className: \"py-2 cursor-pointer\", onClick: () => login(name) },\r\n                                    \"\\u767B\\u5F55\\u8D26\\u53F7 \",\r\n                                    React.createElement(\"strong\", { className: \"text-primary\" },\r\n                                        name,\r\n                                        \" \"));\r\n                            }))));\r\n            }\r\n        };\r\n    }\r\n    open(users) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.openPage(this.page, { users: users });\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=register.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as React from 'react';\r\nimport { nav, Page, Form, resLang } from '../components';\r\nimport { RegisterController, ForgetController } from './register';\r\nimport { userApi } from '../net';\r\nimport { loginRes } from './res';\r\nimport { tonvaTop, getSender } from './tools';\r\nconst schema = [\r\n    { name: 'username', type: 'string', required: true, maxLength: 100 },\r\n    { name: 'password', type: 'string', required: true, maxLength: 100 },\r\n    { name: 'login', type: 'submit' },\r\n];\r\nexport default class Login extends React.Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.res = resLang(loginRes);\r\n        this.uiSchema = {\r\n            items: {\r\n                username: { placeholder: '手机/邮箱/用户名', label: '登录账号' },\r\n                password: { widget: 'password', placeholder: '密码', label: '密码' },\r\n                login: { widget: 'button', className: 'btn btn-primary btn-block mt-3', label: '登录' },\r\n            }\r\n        };\r\n        this.onSubmit = (name, context) => __awaiter(this, void 0, void 0, function* () {\r\n            let values = context.form.data;\r\n            let un = values['username'];\r\n            let pwd = values['password'];\r\n            if (pwd === undefined) {\r\n                return 'something wrong, pwd is undefined';\r\n            }\r\n            let user = yield userApi.login({\r\n                user: un,\r\n                pwd: pwd,\r\n                guest: nav.guest,\r\n            });\r\n            if (user === undefined) {\r\n                let sender = getSender(un);\r\n                let type = sender !== undefined ? sender.caption : '用户名';\r\n                return type + '或密码错！';\r\n            }\r\n            console.log(\"onLoginSubmit: user=%s pwd:%s\", user.name, user.token);\r\n            yield nav.logined(user, this.props.callback);\r\n        });\r\n        this.onEnter = (name, context) => __awaiter(this, void 0, void 0, function* () {\r\n            if (name === 'password') {\r\n                return yield this.onSubmit('login', context);\r\n            }\r\n        });\r\n        this.clickReg = () => {\r\n            //nav.replace(<RegisterView />);\r\n            let register = new RegisterController(undefined);\r\n            register.start();\r\n        };\r\n        this.clickForget = () => {\r\n            let forget = new ForgetController(undefined);\r\n            forget.start();\r\n        };\r\n    }\r\n    render() {\r\n        let footer = React.createElement(\"div\", null,\r\n            React.createElement(\"div\", { className: \"d-block\" },\r\n                React.createElement(\"div\", { className: 'text-center' },\r\n                    React.createElement(\"button\", { className: \"btn btn-link\", style: { margin: '0px auto' }, onClick: this.clickReg }, \"\\u6CE8\\u518C\\u8D26\\u53F7\")),\r\n                nav.privacyEntry()));\r\n        let header = false;\r\n        if (this.props.withBack === true) {\r\n            header = '登录';\r\n        }\r\n        return React.createElement(Page, { header: header, footer: footer },\r\n            React.createElement(\"div\", { className: \"d-flex h-100 flex-column justify-content-center align-items-center\" },\r\n                React.createElement(\"div\", { className: \"flex-fill\" }),\r\n                React.createElement(\"div\", { className: \"w-20c\" },\r\n                    tonvaTop(),\r\n                    React.createElement(\"div\", { className: \"h-2c\" }),\r\n                    React.createElement(Form, { schema: schema, uiSchema: this.uiSchema, onButtonClick: this.onSubmit, onEnter: this.onEnter, requiredFlag: false }),\r\n                    React.createElement(\"button\", { className: \"btn btn-link btn-block\", onClick: () => this.clickForget() }, \"\\u5FD8\\u8BB0\\u5BC6\\u7801\")),\r\n                React.createElement(\"div\", { className: \"flex-fill\" }),\r\n                React.createElement(\"div\", { className: \"flex-fill\" })));\r\n    }\r\n}\r\n//# sourceMappingURL=login.js.map"],"sourceRoot":""}